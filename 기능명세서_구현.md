# YouTube 교육 컨트롤러 - 기능 구현 현황

> **최종 업데이트:** 2025-12-27 (학습 타이머 시스템 개선)
> **프로젝트:** YouTube Edu Controller
> **기술 스택:** Flutter 3.9.2+, Dart, Riverpod, YouTube Data API v3, OpenAI API

---

## 📊 구현 현황 요약

| 카테고리 | 구현 완료 | 개발 중 | 미구현 | 진행률 |
|---------|----------|---------|--------|--------|
| UI/UX | 7개 화면 | - | 2개 화면 | 78% |
| YouTube 연동 | 5개 기능 | - | 4개 기능 | 56% |
| 인증 시스템 | 3개 기능 | - | - | 100% |
| 플레이어 | 3개 기능 | - | 5개 기능 | 38% |
| **학습 시스템** | **9개 기능** | - | **2개 기능** | **82%** ⬆️ |
| 데이터 관리 | 3개 기능 | - | 3개 기능 | 50% |
| **전체** | **30개** ⬆️ | - | **16개** | **65%** ⬆️ |

---

## ✅ 구현 완료된 기능

### 1. UI/UX 기본 구조

#### 1.1 Splash 화면
- [x] 앱 로고 표시 (커스텀 아이콘)
- [x] 페이드 인/아웃 애니메이션
- [x] 자동 온보딩 화면 전환 (3초)
- **파일:** `lib/views/screens/splash_screen.dart`

#### 1.2 온보딩 화면
- [x] 앱 소개 페이지
- [x] Google 로그인 버튼
- **파일:** `lib/views/screens/onboarding_screen.dart`

#### 1.3 홈 화면
- [x] YouTube 스타일 UI
- [x] 검색 기능 (검색 탭)
- [x] 추천 영상 피드 (무한 스크롤)
- [x] Shorts 탭 (그리드 레이아웃)
- [x] 보관함 탭 (시청 기록)
- [x] 하단 네비게이션 바
- **파일:** `lib/views/screens/home_screen.dart`

#### 1.4 플레이어 화면
- [x] 전체 화면 플레이어
- [x] 영상 정보 표시
- [x] 기본 UI 구조
- **파일:** `lib/views/screens/player_screen.dart`

#### 1.5 퀴즈 화면
- [x] 전체 화면 인터페이스
- [x] 객관식 선택지 표시
- [x] 정답/오답 피드백
- [x] 힌트 시스템
- **파일:** `lib/views/screens/question_screen.dart`

#### 1.6 프로필 화면
- [x] 사용자 정보 표시
- [x] Google 계정 연동 상태
- **파일:** `lib/views/screens/profile_screen.dart`

#### 1.7 설정 화면
- [x] 기본 설정 페이지
- [x] 학습 타이머 간격 조정
- **파일:** `lib/views/screens/settings_screen.dart`

---

### 2. YouTube 연동

#### 2.1 YouTube Data API v3
- [x] API 클라이언트 구현
- [x] 안전한 API 키 관리
- **파일:** `lib/services/api/youtube_service.dart`

#### 2.2 영상 검색
- [x] 키워드 검색 기능
- [x] Safe Search 적용
- [x] 임베드 가능한 영상만 필터링
- **메서드:** `searchVideos()`

#### 2.3 인기 영상
- [x] 지역별 인기 영상 가져오기 (KR 기본)
- [x] 페이지네이션 지원
- **메서드:** `getPopularVideos()`

#### 2.4 Shorts 영상
- [x] Shorts 영상 검색
- [x] 짧은 길이 영상 필터링
- **메서드:** `getShorts()`

#### 2.5 개인화된 추천
- [x] 사용자 로그인 시 개인화 추천
- [x] 로그아웃 시 일반 추천 대체
- [x] 시청 기록 기반 알고리즘
- **메서드:** `getPersonalizedRecommendations()`, `getPersonalizedShorts()`

---

### 3. 인증 시스템

#### 3.1 Google Sign-In
- [x] OAuth 2.0 인증
- [x] Google 계정 로그인
- [x] 로그아웃 기능
- **파일:** `lib/services/auth/google_auth_service.dart`

#### 3.2 토큰 관리
- [x] Access Token 발급 및 저장
- [x] 토큰 자동 갱신
- **메서드:** `getAccessToken()`, `signIn()`, `signOut()`

#### 3.3 계정 연동 상태
- [x] YouTube 계정 연동 확인
- [x] 프로필 화면 연동 상태 표시
- **메서드:** `isSignedIn()`

---

### 4. 비디오 플레이어

#### 4.1 YouTube 플레이어 위젯
- [x] YouTube IFrame Player 구현
- [x] 기본 재생 컨트롤
- **파일:** `lib/widgets/player/youtube_player_widget.dart`

#### 4.2 재생 추적
- [x] 재생 시간 추적
- [x] 위치 변경 콜백
- **메서드:** `_onPositionChanged()`

#### 4.3 시청 기록
- [x] 자동 시청 기록 저장
- [x] 영상 메타데이터 저장 (제목, 채널, 썸네일)
- **메서드:** `_saveToWatchHistory()`

---

### 5. 학습 타이머 시스템 ⭐ **업데이트**

#### 5.1 타이머 서비스 (Riverpod) ✅ **완료**
- [x] **LearningTimerService** 구현
- [x] StateNotifier 기반 상태 관리
- [x] ~~15분 간격~~ → **15초 간격으로 변경** (테스트용)
- [x] 1초마다 타이머 업데이트
- [x] 실시간 남은 시간 표시
- **파일:** `lib/services/timer/learning_timer_service.dart`
- **Provider:** `learningTimerProvider`

#### 5.2 타이머 제어 ✅ **완료**
- [x] 세션 시작/일시정지/재개/중지
- [x] **퀴즈 진입 시 자동 일시정지**
- [x] **퀴즈 종료 시 자동 재시작**
- [x] 학습 브레이크 트리거
- **메서드:** `startSession()`, `pauseSession()`, `resumeSession()`, `stopSession()`
- **파일:** `lib/services/timer/learning_timer_service.dart:21-67`

#### 5.3 플레이어 화면 통합 ✅ **완료**
- [x] learningTimerProvider 연동
- [x] 실시간 타이머 상태 UI 표시
- [x] 퀴즈 네비게이션 시 타이머 제어
- [x] 화면 종료 시 타이머 정리
- **파일:** `lib/views/screens/player_screen.dart:8, 35-40, 79-82, 118-134`

#### 5.4 퀴즈 팝업
- [x] 15초 경과 시 자동 팝업
- [x] 전체 화면 퀴즈 다이얼로그
- [x] "나중에" / "문제 풀기" 옵션
- **메서드:** `_showStudyPopup()`
- **파일:** `lib/views/screens/player_screen.dart:85-116`

---

### 6. AI 퀴즈 시스템 ⭐ **NEW**

#### 6.1 OpenAI API 연동 ✅ **완료**
- [x] **API 키 설정 완료**
- [x] gpt-4o-mini 모델 사용
- [x] 실시간 AI 문제 생성
- [x] JSON 응답 형식 검증
- **파일:** `lib/config/app_config.dart:8`
- **메서드:** `_generateQuestionWithAI()`

#### 6.2 고도화된 프롬프트 엔지니어링 ✅ **완료**
- [x] **학년별 맞춤 프롬프트** (초등 1-6, 중등 1-3, 고등 1-3)
- [x] **과목별 세부 가이드**
  - Mathematics, Korean, English, Science, Social Studies, History
  - 각 과목마다 학년별 교육 내용 명시
- [x] **난이도별 문제 생성** (쉬운/보통/어려운)
- [x] **한국 교육과정 반영**
- **메서드:** `_buildSystemPrompt()`, `_buildUserPrompt()`
- **파일:** `lib/services/ai/question_generator_service.dart:141-295`

#### 6.3 Question 모델 확장 ✅ **완료**
- [x] **hint 필드 추가** (optional)
- [x] fromJson/toJson 업데이트
- [x] 정답 힌트 제공 시스템
- **파일:** `lib/models/question_model.dart:13`

#### 6.4 개선된 문제 은행 ✅ **완료**
- [x] 하드코딩된 백업 문제 (AI 실패 시 사용)
- [x] 모든 문제에 **힌트** 추가
- [x] **해설 강화** (2-3문장)
- [x] 과목별 분류 (수학, 국어, 영어, 과학)
- **파일:** `lib/services/ai/question_generator_service.dart:16-77`

#### 6.5 퀴즈 화면 UI 개선 ✅ **완료**
- [x] **힌트 표시 기능** 추가
- [x] 오답 시 힌트 보기 버튼
- [x] 시각적 힌트 디자인 (노란색 배경, 전구 아이콘)
- [x] Null-safe 힌트 처리
- **메서드:** `_buildHint()`
- **파일:** `lib/views/screens/question_screen.dart:553-591`

#### 6.6 문제 생성 로직 ✅ **완료**
- [x] 랜덤 문제 선택
- [x] 객관식 4지선다
- [x] AI 우선, 실패 시 하드코딩 문제 사용
- **메서드:** `generateQuestion()`

#### 6.7 정답 검증 시스템 ✅ **완료**
- [x] 답안 체크 로직
- [x] 정답/오답 피드백
- [x] 상세 해설 제공
- [x] 최대 3회 재시도
- [x] 포인트 시스템 (시도 횟수별 차등 점수)

#### 6.8 과목별 특화 프롬프트 ✅ **완료**
- [x] **수학**: 학년별 연산/도형/함수 범위
- [x] **국어**: 어휘/문법/문학 단계별
- [x] **영어**: 알파벳부터 고급 문법까지
- [x] **과학**: 생물/물리/화학/지구과학
- [x] **사회**: 지리/경제/정치
- [x] **역사**: 한국사/세계사
- **메서드:** `_getSubjectGuide()`

#### 6.9 난이도 자동 가이드 ✅ **완료**
- [x] **쉬운**: 기본 개념, 단순 암기
- [x] **보통**: 개념 적용, 사고력 필요
- [x] **어려운**: 종합적 분석, 추론 능력
- **메서드:** `_getDifficultyGuide()`

---

### 7. 로컬 저장소

#### 7.1 시청 기록 저장
- [x] SharedPreferences 활용
- [x] 영상 메타데이터 저장
- **파일:** `lib/services/storage/local_storage_service.dart`

#### 7.2 사용자 설정
- [x] 학습 간격 저장
- [x] 앱 설정 저장
- **메서드:** `init()`, `addToWatchHistory()`

#### 7.3 데이터 조회
- [x] 시청 기록 불러오기
- [x] 보관함 화면 연동
- **메서드:** `getWatchHistory()`

---

## 🔄 개발 중인 기능

### 1. AI 퀴즈 고도화
- ⏳ OpenAI API 실제 활용 (현재 API 키 미설정으로 하드코딩 사용)
- ⏳ 동적 문제 생성
- ⏳ 난이도 자동 조정 알고리즘

**예상 작업:**
- `app_config.dart`에 실제 OpenAI API 키 설정
- `_generateQuestionWithAI()` 메서드 활성화
- 프롬프트 엔지니어링 최적화

---

### 2. 사용자 프로필 완성
- ⏳ 학습 수준 설정 UI
- ⏳ 선호 과목/취약 과목 관리
- ⏳ 프로필 사진 업로드 기능

**예상 작업:**
- `profile_screen.dart` UI 확장
- `user_model.dart` 데이터 모델 완성
- 로컬 저장소에 프로필 정보 저장

---

### 3. 학습 통계 대시보드
- ⏳ 일일/주간/월간 학습 시간
- ⏳ 퀴즈 정답률 통계
- ⏳ 과목별 학습 현황

**예상 작업:**
- 새로운 통계 화면 생성
- 차트 라이브러리 추가 (fl_chart)
- 학습 데이터 수집 및 분석 로직

---

## 📋 향후 구현 예정 기능

### Phase 2: 안전성 및 관리 기능 (예상 2-3개월)

#### 1. 콘텐츠 필터링 🛡️
- [ ] 연령 부적합 키워드 차단
- [ ] 채널 블랙리스트 기능
- [ ] 채널 화이트리스트 기능
- [ ] 카테고리별 시청 제한 (게임, 음악 등)
- [ ] 교육 콘텐츠 우선 노출 알고리즘

**필요 작업:**
- 키워드 필터링 서비스 구현
- 채널 관리 UI 추가
- 설정 화면에 필터링 옵션 추가

---

#### 2. 부모/교사 모드 👨‍👩‍👧‍👦
- [ ] 원격 설정 변경
- [ ] 실시간 시청 모니터링
- [ ] 학습 리포트 이메일 전송
- [ ] 시청 시간 제한 설정
- [ ] 비밀번호 보호

**필요 작업:**
- Firebase 백엔드 구축
- 부모/교사 계정 시스템
- 실시간 데이터베이스 연동

---

#### 3. YouTube 알고리즘 활용 확대
- [ ] 구독 채널 최신 동영상 피드
- [ ] 사용자 재생목록 가져오기
- [ ] 좋아요 표시한 동영상 조회
- [ ] 나중에 볼 동영상 연동
- [ ] 시청 기록 동기화 (YouTube ↔ 앱)

**필요 작업:**
- YouTube Data API 추가 엔드포인트 연동
- OAuth 스코프 확장
- UI에 새로운 피드 섹션 추가

---

### Phase 3: 고급 기능 (예상 4-6개월)

#### 4. 클라우드 동기화
- [ ] Firebase Firestore 연동
- [ ] 다중 기기 학습 진도 동기화
- [ ] 클라우드 백업 및 복원
- [ ] 실시간 데이터 동기화

**필요 작업:**
- Firebase 프로젝트 설정
- Firestore 데이터 모델 설계
- 오프라인 모드 지원

---

#### 5. 플레이어 고도화
- [ ] 백그라운드 재생 시 타이머 동작
- [ ] 재생 속도 조절 (0.5x ~ 2.0x)
- [ ] 자막 표시 및 언어 선택
- [ ] 화질 선택 (360p ~ 1080p)
- [ ] PiP (Picture-in-Picture) 모드

**필요 작업:**
- YouTube Player API 고급 옵션 활용
- 백그라운드 서비스 구현
- 자막 API 연동

---

#### 6. 퀴즈 시스템 확장
- [ ] 주관식 문제 추가
- [ ] 서술형 문제 (AI 자동 채점)
- [ ] 문제 풀이 해설 강화
- [ ] 오답노트 기능
- [ ] 문제 난이도 피드백 시스템

**필요 작업:**
- 문제 유형별 UI 구현
- OpenAI API 활용 자동 채점
- 오답 데이터 저장 및 관리

---

#### 7. 게임화 요소
- [ ] 포인트 시스템 (문제 풀면 포인트 획득)
- [ ] 배지 시스템 (달성 업적)
- [ ] 레벨 시스템 (경험치 누적)
- [ ] 학습 랭킹 (친구/전체)
- [ ] 일일 미션

**필요 작업:**
- 게임화 데이터 모델 설계
- 포인트/배지 UI 구현
- 랭킹 시스템 백엔드

---

#### 8. 기타 편의 기능
- [ ] 다크 모드 (시스템 설정 연동)
- [ ] 다국어 지원 (영어, 한국어)
- [ ] 태블릿 최적화
- [ ] 가로 모드 지원
- [ ] 푸시 알림 (학습 알림)

---

## 🎯 우선순위별 로드맵

### **Phase 1: 핵심 기능 완성** (현재 ~ 1개월)

**목표:** MVP (Minimum Viable Product) 완성

1. **OpenAI API 활성화** (우선순위: ⭐⭐⭐⭐⭐)
   - 실제 API 키 설정
   - AI 문제 생성 테스트
   - 프롬프트 최적화
   - **예상 기간:** 1주

2. **사용자 프로필 완성** (우선순위: ⭐⭐⭐⭐)
   - 학습 수준 설정 UI
   - 프로필 정보 저장
   - **예상 기간:** 1주

3. **학습 통계 대시보드** (우선순위: ⭐⭐⭐⭐)
   - 기본 통계 화면
   - 학습 시간/정답률 표시
   - **예상 기간:** 1주

4. **버그 수정 및 안정화** (우선순위: ⭐⭐⭐⭐⭐)
   - 크래시 수정
   - 성능 최적화
   - **예상 기간:** 1주

---

### **Phase 2: 안전성 및 확장** (2-3개월)

**목표:** 안전한 시청 환경 + 부모/교사 기능

1. **콘텐츠 필터링** (우선순위: ⭐⭐⭐⭐⭐)
   - 아동 보호 필수 기능
   - **예상 기간:** 2주

2. **부모/교사 모드 (기초)** (우선순위: ⭐⭐⭐⭐)
   - 원격 모니터링
   - 학습 리포트
   - **예상 기간:** 3주

3. **YouTube 알고리즘 확대** (우선순위: ⭐⭐⭐)
   - 구독 채널 피드
   - 재생목록 연동
   - **예상 기간:** 2주

4. **클라우드 동기화 (Firebase)** (우선순위: ⭐⭐⭐⭐)
   - Firestore 연동
   - 다중 기기 지원
   - **예상 기간:** 3주

---

### **Phase 3: 출시 준비** (4-6개월)

**목표:** 앱스토어 출시 및 마케팅

1. **고급 AI 기능** (우선순위: ⭐⭐⭐)
   - 난이도 자동 조정
   - 서술형 문제 채점
   - **예상 기간:** 3주

2. **게임화 요소** (우선순위: ⭐⭐⭐)
   - 포인트/배지 시스템
   - 랭킹 시스템
   - **예상 기간:** 3주

3. **플레이어 고도화** (우선순위: ⭐⭐)
   - 백그라운드 재생
   - PiP 모드
   - **예상 기간:** 2주

4. **앱스토어 출시 준비** (우선순위: ⭐⭐⭐⭐⭐)
   - 정책 준수 검토
   - 스크린샷 준비
   - 설명 작성
   - **예상 기간:** 2주

---

## 📈 기술 부채 및 개선 사항

### 코드 품질
- [ ] 단위 테스트 작성 (현재 0%)
- [ ] 통합 테스트 작성
- [ ] 코드 리뷰 프로세스 도입
- [ ] Linting 규칙 강화

### 성능 최적화
- [ ] 이미지 캐싱 최적화
- [ ] API 요청 최소화 (캐싱 전략)
- [ ] 메모리 누수 확인
- [ ] 앱 번들 크기 최적화

### 보안
- [ ] API 키 환경 변수화
- [ ] 민감 정보 암호화 강화
- [ ] HTTPS 통신 검증
- [ ] COPPA/GDPR-K 준수 검토

---

## 🔍 주요 파일 구조

```
youtube_edu_controller/
├── lib/
│   ├── config/
│   │   ├── app_config.dart          # API 키 및 설정
│   │   ├── app_routes.dart          # 라우팅 설정
│   │   └── app_theme.dart           # 앱 테마
│   ├── models/
│   │   ├── question_model.dart      # 퀴즈 문제 모델
│   │   ├── study_session_model.dart # 학습 세션 모델
│   │   └── user_model.dart          # 사용자 모델
│   ├── services/
│   │   ├── ai/
│   │   │   └── question_generator_service.dart  # AI 퀴즈 생성
│   │   ├── api/
│   │   │   └── youtube_service.dart             # YouTube API
│   │   ├── auth/
│   │   │   └── google_auth_service.dart         # Google 인증
│   │   ├── storage/
│   │   │   └── local_storage_service.dart       # 로컬 저장소
│   │   └── timer/
│   │       └── learning_timer_service.dart      # 학습 타이머
│   ├── views/
│   │   └── screens/
│   │       ├── splash_screen.dart    # ✅ 완성
│   │       ├── onboarding_screen.dart # ✅ 완성
│   │       ├── home_screen.dart      # ✅ 완성
│   │       ├── player_screen.dart    # ✅ 완성
│   │       ├── question_screen.dart  # ✅ 완성
│   │       ├── profile_screen.dart   # ⏳ 개발 중
│   │       └── settings_screen.dart  # ⏳ 개발 중
│   ├── widgets/
│   │   └── player/
│   │       └── youtube_player_widget.dart # ✅ 완성
│   └── main.dart                     # 앱 진입점
├── assets/
│   └── app_icon.png                  # 앱 아이콘
├── pubspec.yaml                      # 의존성 관리
└── README.md                         # 프로젝트 문서
```

---

## 🚀 다음 작업 제안

### 즉시 시작 가능한 작업 (Quick Wins)

1. **OpenAI API 활성화** ⭐⭐⭐⭐⭐
   - API 키만 설정하면 바로 작동
   - 하드코딩된 문제에서 AI 생성으로 전환
   - **예상 시간:** 2-3시간

2. **다크 모드 구현** ⭐⭐⭐
   - 이미 `app_theme.dart`에 darkTheme 준비됨
   - main.dart에서 `themeMode: ThemeMode.system` 이미 설정
   - **예상 시간:** 1-2시간

3. **프로필 사진 업로드** ⭐⭐⭐
   - `image_picker` 패키지 추가
   - 로컬 저장소에 경로 저장
   - **예상 시간:** 2-3시간

### 중요도 높은 작업

1. **콘텐츠 필터링** (아동 안전)
2. **학습 통계 대시보드** (사용자 경험)
3. **부모/교사 모드** (차별화 기능)

---

## 📞 문의 및 건의사항

기능 구현 우선순위나 추가 기능에 대한 의견이 있으시면 언제든 말씀해주세요!

---

## 📝 최근 변경 이력

### 2025-12-27: 학습 타이머 시스템 개선
- ✅ 타이머 간격 15초로 단축 (테스트 용이성)
- ✅ 퀴즈 진입 시 타이머 자동 일시정지
- ✅ 퀴즈 종료 시 타이머 자동 재시작
- ✅ Riverpod 기반 타이머 서비스 통합
- ✅ 실시간 타이머 상태 UI 업데이트

### 2025-12-20: AI 퀴즈 고도화
- ✅ OpenAI API 연동 완료
- ✅ 학년별/과목별 맞춤 프롬프트
- ✅ 힌트 시스템 추가

---

**작성일:** 2025-12-27
**작성자:** Claude Code Assistant
